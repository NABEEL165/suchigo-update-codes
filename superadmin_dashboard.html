<!DOCTYPE html>
{% load static %}
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SuchiGo Admin Dashboard</title>
    {% csrf_token %}
    <meta name="csrf-token" content="{{ csrf_token }}">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary: #4CAF50;
            --primary-dark: #388E3C;
            --secondary: #2196F3;
            --warning: #FF9800;
            --purple: #9C27B0;
            --gray: #666;
            --light: #f8f9fa;
            --dark: #333;
        }

        .reports-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(340px, 1fr));
            gap: 1.8rem;
            margin: 2rem 0;
        }

        .report-card {
            background: white;
            border-radius: 16px;
            box-shadow: 0 8px 30px rgba(0,0,0,0.08);
            overflow: hidden;
            transition: all 0.28s ease;
            border: 1px solid rgba(0,0,0,0.04);
        }

        .report-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 50px rgba(0,0,0,0.12);
        }

        .report-card-header {
            padding: 1.4rem 1.8rem;
            border-bottom: 1px solid #eee;
            display: flex;
            align-items: center;
            gap: 1rem;
            background: linear-gradient(135deg, rgba(240,245,255,0.4), white);
        }

        .report-card-header i {
            font-size: 1.6rem;
        }

        .report-card-header h5 {
            font-size: 1.25rem;
            margin: 0;
            color: var(--dark);
        }

        .report-card-body {
            padding: 1.6rem 1.8rem;
        }

        .report-btn {
            width: 100%;
            padding: 1rem 1.4rem;
            margin-bottom: 0.9rem;
            border: 1px solid #e0e0e0;
            border-radius: 10px;
            background: white;
            color: var(--dark);
            font-size: 0.98rem;
            cursor: pointer;
            transition: all 0.25s ease;
            display: flex;
            align-items: center;
            gap: 0.9rem;
            text-align: left;
        }

        .report-btn:hover {
            background: linear-gradient(135deg, #f0f7ff, #e3f2fd);
            border-color: var(--secondary);
            transform: translateX(6px);
            box-shadow: 0 6px 20px rgba(33,150,243,0.12);
        }

        .report-btn i {
            width: 24px;
            text-align: center;
            font-size: 1.2rem;
        }

        .report-history {
            background: white;
            border-radius: 16px;
            box-shadow: 0 8px 30px rgba(0,0,0,0.08);
            overflow: hidden;
            margin-top: 2rem;
        }

        .report-history-header {
            padding: 1.5rem 2rem;
            background: var(--light);
            border-bottom: 1px solid #eee;
        }

        .report-history-header h4 {
            margin: 0;
            font-size: 1.4rem;
            display: flex;
            align-items: center;
            gap: 0.8rem;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 1.2rem 1.6rem;
            text-align: left;
            border-bottom: 1px solid #f0f0f0;
        }

        th {
            background: var(--light);
            font-weight: 600;
            color: #444;
        }

        .status-badge {
            padding: 0.4rem 1rem;
            border-radius: 50px;
            font-size: 0.85rem;
            font-weight: 500;
        }

        .status-badge[data-status="Completed"]  { background:#e8f5e9; color:#2e7d32; }
        .status-badge[data-status="Generated"]  { background:#e3f2fd; color:#1565c0; }
        .status-badge[data-status="Failed"]     { background:#ffebee; color:#c62828; }

        .action-buttons {
            display: flex;
            gap: 0.6rem;
        }

        .action-btn {
            padding: 0.5rem 0.9rem;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.2s;
        }

        .btn-download { background:#2196F3; color:white; }
        .btn-delete   { background:#f44336; color:white; }

        @media (max-width: 768px) {
            .reports-grid { grid-template-columns: 1fr; }
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #ffffff;
            min-height: 100vh;
            color: #333;
        }

        /* Top Navbar */
        .top-navbar {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            padding: 1rem 2rem;
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1001;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .navbar-left {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .menu-toggle {
            display: none;
            background: none;
            border: none;
            font-size: 1.5rem;
            color: #333;
            cursor: pointer;
            padding: 0.5rem;
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .logo-img {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: linear-gradient(135deg, #4CAF50, #2196F3);
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            position: relative;
            font-size: 1.2rem;
            color: white;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .logo-img img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
            position: absolute;
            top: 0;
            left: 0;
        }

        .logo-img .fallback-icon {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            height: 100%;
            font-size: 1.2rem;
        }

        .logo-text {
            font-size: 1.5rem;
            font-weight: bold;
            background: linear-gradient(135deg, #4CAF50, #2196F3);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }


        .search-container {
            position: relative;
            margin-left: 2rem;
        }

        .search-input {
            width: 350px;
            padding: 0.75rem 1rem 0.75rem 3rem;
            border: 2px solid rgba(102, 126, 234, 0.2);
            border-radius: 25px;
            background: rgba(248, 249, 250, 0.8);
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .search-input:focus {
            outline: none;
            border-color: #4CAF50;
            background: white;
            box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.1);
        }

        .search-icon {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: #666;
        }

        .navbar-right {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .notification-btn {
            position: relative;
            background: none;
            border: none;
            font-size: 1.2rem;
            color: #666;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 10px;
            transition: all 0.3s ease;
        }

        .notification-btn:hover {
            background: rgba(102, 126, 234, 0.1);
            color: #4CAF50;
        }

        .notification-badge {
            position: absolute;
            top: 0;
            right: 0;
            background: #ff4757;
            color: white;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            font-size: 0.7rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .profile-dropdown {
            position: relative;
        }

        .profile-trigger {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.5rem 1rem;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: rgba(102, 126, 234, 0.1);
        }

        .profile-trigger:hover {
            background: rgba(102, 126, 234, 0.2);
        }

        .profile-avatar {
            width: 35px;
            height: 35px;
            background: linear-gradient(135deg, #4CAF50, #2196F3);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 0.9rem;
        }

        .profile-info {
            display: flex;
            flex-direction: column;
        }

        .profile-name {
            font-weight: 600;
            font-size: 0.9rem;
            color: #333;
        }

        .profile-role {
            font-size: 0.75rem;
            color: #666;
        }

        .dropdown-arrow {
            margin-left: 0.5rem;
            font-size: 0.8rem;
            color: #666;
            transition: transform 0.3s ease;
        }

        .profile-dropdown.active .dropdown-arrow {
            transform: rotate(180deg);
        }

        .dropdown-menu {
            position: absolute;
            top: 100%;
            right: 0;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
            padding: 1rem 0;
            min-width: 200px;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .profile-dropdown.active .dropdown-menu {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .dropdown-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1.5rem;
            color: #333;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .dropdown-item:hover {
            background: rgba(102, 126, 234, 0.1);
            color: #4CAF50;
        }

        .dropdown-item.logout {
            border-top: 1px solid #eee;
            margin-top: 0.5rem;
            color: #ff4757;
        }

        .dropdown-item.logout:hover {
            background: rgba(255, 71, 87, 0.1);
            color: #ff4757;
        }

        /* Sidebar */
        .sidebar {
            width: 280px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            box-shadow: 2px 0 20px rgba(0, 0, 0, 0.1);
            position: fixed;
            top: 80px;
            left: 0;
            height: calc(100vh - 80px);
            overflow-y: auto;
            z-index: 1000;
            transition: transform 0.3s ease;
        }

        .sidebar.collapsed {
            transform: translateX(-100%);
        }

        .sidebar-content {
            padding: 2rem 0;
        }

        .nav-section {
            margin-bottom: 2rem;
        }

        .nav-title {
            padding: 0 2rem;
            font-size: 0.8rem;
            font-weight: 600;
            color: #999;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 1rem;
        }

        .nav-item {
            margin: 0.5rem 1rem;
            border-radius: 12px;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .nav-item:hover {
            transform: translateX(5px);
        }

        .nav-link {
            display: flex;
            align-items: center;
            padding: 1rem 1.5rem;
            text-decoration: none;
            color: #555;
            transition: all 0.3s ease;
            position: relative;
        }

        .nav-link:hover {
            background: linear-gradient(135deg, rgba(76, 175, 80, 0.1), rgba(33, 150, 243, 0.1));
            color: #2196F3;
        }

        .nav-link.active {
            background: linear-gradient(135deg, #4CAF50, #2196F3);
            color: white;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .nav-icon {
            width: 20px;
            margin-right: 1rem;
            text-align: center;
        }

        .nav-text {
            flex: 1;
            font-weight: 500;
        }

        /* Main Content */
        .main-content {
            margin-left: 280px;
            margin-top: 80px;
            padding: 2rem;
            transition: margin-left 0.3s ease;
        }

        .main-content.expanded {
            margin-left: 0;
        }

        .welcome-header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        .welcome-header h1 {
            font-size: 2.5rem;
            background: linear-gradient(135deg, #4CAF50, #2196F3);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.5rem;
        }

        .welcome-header p {
            color: #666;
            font-size: 1.1rem;
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 2rem;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(135deg, #4CAF50, #2196F3);
        }

        .stat-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2);
        }

        .stat-icon {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #4CAF50, #2196F3);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            margin-bottom: 1rem;
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: bold;
            color: #333;
            margin-bottom: 0.5rem;
        }

        .stat-label {
            color: #666;
            font-size: 1rem;
            font-weight: 500;
        }

        /* Content Area */
        .content-area {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 2rem;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            min-height: 400px;
        }

        .content-header {
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid rgba(102, 126, 234, 0.1);
        }

        .content-title {
            font-size: 1.8rem;
            color: #333;
            font-weight: 600;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .menu-toggle {
                display: block;
            }

            .search-container {
                display: none;
            }

            .profile-info {
                display: none;
            }

            .sidebar {
                transform: translateX(-100%);
            }

            .sidebar.active {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
            }

            .top-navbar {
                padding: 1rem;
            }

            .welcome-header h1 {
                font-size: 2rem;
            }

            .stats-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
            }

            .stat-card {
                padding: 1.5rem;
            }

            .search-input {
                width: 100%;
            }
        }

        @media (max-width: 480px) {
            .welcome-header {
                padding: 1.5rem;
            }

            .welcome-header h1 {
                font-size: 1.8rem;
            }

            .main-content {
                padding: 1rem;
            }

            .content-area {
                padding: 1.5rem;
            }
        }

        /* Mobile Search */
        .mobile-search {
            display: none;
            position: fixed;
            top: 80px;
            left: 0;
            right: 0;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            padding: 1rem;
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
            z-index: 999;
        }

        .mobile-search.active {
            display: block;
        }

        .btn {
            background: linear-gradient(135deg, #4CAF50, #2196F3);
            color: white;
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 15px;
            cursor: pointer;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        }

        .btn.secondary {
            background: rgba(108, 117, 125, 0.1);
            color: #6c757d;
            border: 2px solid rgba(108, 117, 125, 0.2);
        }

        .btn.secondary:hover {
            background: rgba(108, 117, 125, 0.15);
            border-color: rgba(108, 117, 125, 0.3);
        }

        /* Overlay for mobile sidebar */
        .sidebar-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 999;
        }

        .sidebar-overlay.active {
            display: block;
        }

        /* Action Buttons */
        .action-buttons {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .action-button {
            background: linear-gradient(135deg, #4CAF50, #2196F3);
            color: white;
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 15px;
            cursor: pointer;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .action-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        }

        .action-button.secondary {
            background: rgba(108, 117, 125, 0.1);
            color: #6c757d;
            border: 2px solid rgba(108, 117, 125, 0.2);
        }

        .action-button.secondary:hover {
            background: rgba(108, 117, 125, 0.15);
            border-color: rgba(108, 117, 125, 0.3);
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 10000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }

        .modal-content {
            background-color: white;
            margin: 10% auto;
            padding: 2rem;
            border-radius: 15px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid #eee;
        }

        .modal-header h3 {
            margin: 0;
            color: #333;
        }

        .close {
            font-size: 1.8rem;
            font-weight: bold;
            color: #aaa;
            cursor: pointer;
        }

        .close:hover {
            color: #333;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: #333;
        }

        .form-group select,
        .form-group input {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
        }

        .form-group select:focus,
        .form-group input:focus {
            outline: none;
            border-color: #4CAF50;
            box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.1);
        }

        .modal-actions {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
        }

        /* Share Buttons */
        .share-buttons {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .share-btn {
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 0.5rem;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
        }

        .share-btn:hover {
            background: white;
            color: #333;
            transform: scale(1.1);
        }
    </style>
</head>

<body>
    <!-- Top Navbar -->
    <div class="top-navbar">
        <div class="navbar-left">
            <button class="menu-toggle" onclick="toggleSidebar()">
                <i class="fas fa-bars"></i>
            </button>
            <div class="logo-container">
                <div class="logo-img">
                    <img src="{% static 'images/logo.png.jpg' %}" alt="SuchiGo Logo"
                        onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                    <div class="fallback-icon" style="display: none;">
                        <i class="fas fa-recycle"></i>
                    </div>
                </div>
                <div class="logo-text">SuchiGo</div>
            </div>


            <div class="search-container">
                <i class="fas fa-search search-icon"></i>
                <input type="text" class="search-input" placeholder="Search customers, collectors, or data...">
            </div>
        </div>

        <div class="navbar-right">
            <button class="notification-btn" onclick="toggleMobileSearch()">
                <i class="fas fa-search"></i>
            </button>
            <button class="notification-btn">
                <i class="fas fa-bell"></i>
                <div class="notification-badge">3</div>
            </button>
            <div class="profile-dropdown" onclick="toggleProfileDropdown()">
                <div class="profile-trigger">
                    <div class="profile-avatar">
                        {% if user.first_name or user.last_name %}
                        {{ user.first_name|default_if_none:""|slice:":1" }}{{
                        user.last_name|default_if_none:""|slice:":1" }}
                        {% else %}
                        {{ user.username|slice:":2" }}
                        {% endif %}
                    </div>

                    <div class="profile-info">
                        <div class="profile-name">
                            {% if user.first_name or user.last_name %}
                            {{ user.first_name }} {{ user.last_name }}
                            {% else %}
                            {{ user.username }}
                            {% endif %}
                        </div>
                        <div class="profile-role">Administrator</div>
                    </div>

                    <i class="fas fa-chevron-down dropdown-arrow"></i>
                </div>
                <div class="dropdown-menu">
                    <a href="#" class="dropdown-item">
                        <i class="fas fa-user"></i>
                        My Profile
                    </a>
                    <a href="#" class="dropdown-item">
                        <i class="fas fa-cog"></i>
                        Settings
                    </a>
                    <a href="#" class="dropdown-item">
                        <i class="fas fa-question-circle"></i>
                        Help & Support
                    </a>
                    <a href="{% url 'authentication:logout' %}" class="dropdown-item logout">
                        <i class="fas fa-sign-out-alt"></i>
                        Logout
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile Search -->
    <div class="mobile-search" id="mobileSearch">
        <div class="search-container" style="margin: 0; width: 100%;">
            <i class="fas fa-search search-icon"></i>
            <input type="text" class="search-input" placeholder="Search customers, collectors, or data..."
                style="width: 100%;">
        </div>
    </div>

    <!-- Sidebar Overlay -->
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="closeSidebar()"></div>

    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
        <div class="sidebar-content">
            <!-- Main Navigation -->
            <div class="nav-section">
                <div class="nav-title">Main Menu</div>
                <div class="nav-item">
                    <a href="{% url 'super_admin_dashboard:super_admin_dashboard' %}" class="nav-link active"
                        onclick="showContent('dashboard')">
                        <i class="fas fa-home nav-icon"></i>
                        <span class="nav-text">Dashboard</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="{% url 'super_admin_dashboard:view_customer_waste_info' %}" class="nav-link"
                        onclick="showContent('waste-info')">
                        <i class="fas fa-file-alt nav-icon"></i>
                        <span class="nav-text">Waste Information</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="{% url 'super_admin_dashboard:view_collected_data' %}" class="nav-link"
                        onclick="showContent('collected-data')">
                        <i class="fas fa-database nav-icon"></i>
                        <span class="nav-text">Collected Data</span>
                    </a>
                </div>
            </div>

            <!-- Management Section -->

            <div class="nav-section">
                <div class="nav-title">Management</div>
                <div class="nav-item">
                    <a href="{% url 'super_admin_dashboard:users_list' %}" class="nav-link"
                        onclick="showContent('customer-mgmt')">
                        <i class="fas fa-users-cog"></i>
                        <span class="nav-text">User Management</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="{% url 'super_admin_dashboard:view_customers' %}" class="nav-link"
                        onclick="showContent('customer-mgmt')">
                        <i class="fas fa-users nav-icon"></i>
                        <span class="nav-text">Customer Management</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="{% url 'super_admin_dashboard:view_collectors' %}" class="nav-link"
                        onclick="showContent('collector-mgmt')">
                        <i class="fas fa-truck nav-icon"></i>
                        <span class="nav-text">Waste Collector Management</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="{% url 'super_admin_dashboard:view_admins' %}" class="nav-link"
                        onclick="showContent('admin-mgmt')">
                        <i class="fas fa-user-cog nav-icon"></i>
                        <span class="nav-text">Admin Management</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="{% url 'super_admin_dashboard:view_super_admin' %}" class="nav-link"
                        onclick="showContent('admin-mgmt')">
                        <i class="fas fa-user-shield nav-icon"></i>
                        <span class="nav-text">Super Admin Management</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="{% url 'super_admin_dashboard:create_waste_profile' %}" class="nav-link"
                        onclick="showContent('admin-mgmt')">
                        <!-- Improved icon -->
                        <i class="fas fa-cart-plus nav-icon"></i>
                        <span class="nav-text">Create Order</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="{% url 'super_admin_dashboard:waste_info_list' %}"
                        class="nav-link d-flex align-items-center" onclick="showContent('admin-mgmt')">
                        <i class="fas fa-folder-tree"></i>
                        <span class="nav-text fw-semibold">Managed Waste Profiles</span>
                    </a>
                </div>

                <div class="nav-item">
                    <a href="{% url 'super_admin_dashboard:calendar' %}" class="nav-link"
                        onclick="showContent('admin-mgmt')">
                        <i class="fas fa-calendar-alt nav-icon"></i>
                        <span class="nav-text">Calendar Management</span>
                    </a>
                </div>

            </div>

            <!-- Profile Section -->
            <div class="nav-section">
                <div class="nav-title">Account</div>
                <div class="nav-item">
                    <a href="#" class="nav-link" onclick="showContent('admin-profile')">
                        <i class="fas fa-user-cog nav-icon"></i>
                        <span class="nav-text">Admin Profile</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="{% url 'authentication:logout' %}" class="nav-link" onclick="logout()">
                        <i class="fas fa-sign-out-alt nav-icon"></i>
                        <span class="nav-text">Logout</span>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content" id="mainContent">
        <!-- Welcome Header -->
        <div class="welcome-header">
            <h1>Welcome Back, {{ user.first_name|default:user.username }} {{ user.last_name }}!</h1>
            <p>Manage your waste collection system efficiently with SuchiGo</p>
        </div>

        <!-- Stats Cards -->
        <div class="stats-grid">
            <a href="{% url 'super_admin_dashboard:view_customers' %}" class="stat-card"
                style="text-decoration: none; cursor: pointer;">
                <div class="stat-icon">
                    <i class="fas fa-users"></i>
                </div>
                <div class="stat-value">{{ total_customers }}</div>
                <div class="stat-label">Active Customers</div>
            </a>
            <a href="{% url 'super_admin_dashboard:view_collectors' %}" class="stat-card"
                style="text-decoration: none; cursor: pointer;">
                <div class="stat-icon">
                    <i class="fas fa-truck"></i>
                </div>
                <div class="stat-value">{{ total_collectors }}</div>
                <div class="stat-label">Waste Collectors</div>
            </a>
            <a href="{% url 'super_admin_dashboard:view_collected_data' %}?month=current" class="stat-card"
                style="text-decoration: none; cursor: pointer;">
                <div class="stat-icon">
                    <i class="fas fa-recycle"></i>
                </div>
                <div class="stat-value">{{ monthly_collections }}</div>
                <div class="stat-label">Collections This Month</div>
            </a>
            <a href="{% url 'super_admin_dashboard:view_collected_data' %}" class="stat-card"
                style="text-decoration: none; cursor: pointer;">
                <div class="stat-icon">
                    <i class="fas fa-leaf"></i>
                </div>
                <div class="stat-value">{{ total_waste_collected }}</div>
                <div class="stat-label">Waste Collected</div>
            </a>
        </div>

        <!-- Order Management Section -->
        <div class="page-header" style="text-align: center; margin: 2.5rem 0;">
            <h2 style="font-size: 2.1rem; margin-bottom: 0.6rem; background: linear-gradient(90deg, var(--primary), var(--secondary)); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">Order Management</h2>
            <p style="color: var(--gray); font-size: 1.05rem;">Manage and control all waste collection orders</p>
        </div>

        <!-- Order Statistics -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon">
                    <i class="fas fa-list"></i>
                </div>
                <div class="stat-value">{{ total_orders }}</div>
                <div class="stat-label">Total Orders</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">
                    <i class="fas fa-clock"></i>
                </div>
                <div class="stat-value">{{ pending_orders }}</div>
                <div class="stat-label">Pending Orders</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">
                    <i class="fas fa-sync"></i>
                </div>
                <div class="stat-value">{{ confirmed_orders }}</div>
                <div class="stat-label">In Progress</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">
                    <i class="fas fa-check-circle"></i>
                </div>
                <div class="stat-value">{{ completed_orders }}</div>
                <div class="stat-label">Completed</div>
            </div>
        </div>

        <!-- Recent Orders Table -->
        <div class="content-area" style="margin-top: 2rem;">
            <div class="content-header">
                <h3 class="content-title">Recent Orders</h3>
            </div>
            <div style="overflow-x:auto;">
                <table style="width: 100%; border-collapse: collapse;">
                    <thead>
                        <tr style="background: var(--light);">
                            <th style="padding: 1rem; text-align: left; border-bottom: 2px solid #ddd;">Customer</th>
                            <th style="padding: 1rem; text-align: left; border-bottom: 2px solid #ddd;">Waste Type</th>
                            <th style="padding: 1rem; text-align: left; border-bottom: 2px solid #ddd;">Bags</th>
                            <th style="padding: 1rem; text-align: left; border-bottom: 2px solid #ddd;">Status</th>
                            <th style="padding: 1rem; text-align: left; border-bottom: 2px solid #ddd;">Scheduled Date</th>
                            <th style="padding: 1rem; text-align: left; border-bottom: 2px solid #ddd;">Assigned Collector</th>
                            <th style="padding: 1rem; text-align: left; border-bottom: 2px solid #ddd;">Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for order in orders %}
                        <tr style="border-bottom: 1px solid #eee;">
                            <td style="padding: 1rem;">{{ order.customer_name }}<br><small>{{ order.customer_phone }}</small></td>
                            <td style="padding: 1rem;">{{ order.waste_type }}</td>
                            <td style="padding: 1rem;">{{ order.bags }}</td>
                            <td style="padding: 1rem;">
                                <span class="status-badge" data-status="{{ order.status }}">
                                    {{ order.status }}
                                </span>
                            </td>
                            <td style="padding: 1rem;">{{ order.scheduled_date }}</td>
                            <td style="padding: 1rem;">{{ order.assigned_collector }}</td>
                            <td style="padding: 1rem;">
                                <div class="action-buttons" style="gap: 0.5rem;">
                                    <button class="action-btn btn-download" onclick="openStatusModal({{ order.id }})" title="Update Status">
                                        <i class="fas fa-sync"></i>
                                    </button>
                                    <button class="action-btn" style="background: #2196F3; color: white;" onclick="openRescheduleModal({{ order.id }})" title="Reschedule">
                                        <i class="fas fa-calendar-alt"></i>
                                    </button>
                                    <button class="action-btn" style="background: #FF9800; color: white;" onclick="openAssignModal({{ order.id }})" title="Assign Collector">
                                        <i class="fas fa-user-plus"></i>
                                    </button>
                                </div>
                            </td>
                        </tr>
                        {% empty %}
                        <tr>
                            <td colspan="7" style="padding: 2rem; text-align: center; color: #666;">No orders found</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>

       
    <!-- Modals -->
    <!-- Assign Collector Modal -->
    <div id="assignModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Assign Collector</h3>
                <span class="close" onclick="closeModal('assignModal')">&times;</span>
            </div>
            <form id="assignForm">
                <input type="hidden" id="assignOrderId" name="order_id">
                <input type="hidden" name="action" value="assign_collector">
                <div class="form-group">
                    <label for="collectorSelect">Select Collector:</label>
                    <select id="collectorSelect" name="collector_id" required>
                        <option value="">Choose a collector</option>
                        {% for collector in collectors %}
                        <option value="{{ collector.id }}">{{ collector.get_full_name }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn" style="background: #6c757d;" onclick="closeModal('assignModal')">Cancel</button>
                    <button type="submit" class="btn" style="background: #4CAF50;">Assign Collector</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Update Status Modal -->
    <div id="statusModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Update Order Status</h3>
                <span class="close" onclick="closeModal('statusModal')">&times;</span>
            </div>
            <form id="statusForm">
                <input type="hidden" id="statusOrderId" name="order_id">
                <input type="hidden" name="action" value="update_status">
                <div class="form-group">
                    <label for="statusSelect">New Status:</label>
                    <select id="statusSelect" name="status" required>
                        <option value="">Select status</option>
                        <option value="pending">Pending</option>
                        <option value="in_progress">In Progress</option>
                        <option value="completed">Completed</option>
                        <option value="collected">Collected</option>
                    </select>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn" style="background: #6c757d;" onclick="closeModal('statusModal')">Cancel</button>
                    <button type="submit" class="btn" style="background: #2196F3;">Update Status</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Reschedule Modal -->
    <div id="rescheduleModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Reschedule Order</h3>
                <span class="close" onclick="closeModal('rescheduleModal')">&times;</span>
            </div>
            <form id="rescheduleForm">
                <input type="hidden" id="rescheduleOrderId" name="order_id">
                <input type="hidden" name="action" value="reschedule">
                <div class="form-group">
                    <label for="newDate">New Scheduled Date:</label>
                    <input type="date" id="newDate" name="new_date" required>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn" style="background: #6c757d;" onclick="closeModal('rescheduleModal')">Cancel</button>
                    <button type="submit" class="btn" style="background: #FF9800;">Reschedule</button>
                </div>
            </form>
        </div>
    </div>

    <!-- About Us Modal -->
    <div id="aboutUsModal"
        style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1002;">
        <div
            style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 2rem; border-radius: 15px; max-width: 500px; text-align: center;">
            <h2>About SuchiGo</h2>
            <p>SuchiGo is a comprehensive waste management platform designed to streamline collection, recycling, and
                sustainability efforts for communities and businesses.</p>
            <button onclick="closeAboutUsModal()" class="btn">Close</button>
        </div>
    </div>

    <script>
        // Mobile sidebar toggle
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            const mainContent = document.getElementById('mainContent');

            sidebar.classList.toggle('active');
            overlay.classList.toggle('active');

            if (window.innerWidth > 768) {
                sidebar.classList.toggle('collapsed');
                mainContent.classList.toggle('expanded');
            }
        }

        function closeSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');

            sidebar.classList.remove('active');
            overlay.classList.remove('active');
        }

        // Profile dropdown toggle
        function toggleProfileDropdown() {
            const dropdown = document.querySelector('.profile-dropdown');
            dropdown.classList.toggle('active');
        }

        // Mobile search toggle
        function toggleMobileSearch() {
            const mobileSearch = document.getElementById('mobileSearch');
            mobileSearch.classList.toggle('active');
        }

        // About Us Modal Functions
        function openAboutUsModal() {
            document.getElementById('aboutUsModal').style.display = 'block';
        }

        function closeAboutUsModal() {
            document.getElementById('aboutUsModal').style.display = 'none';
        }

        // Share Services Function
        function shareServices() {
            if (navigator.share) {
                navigator.share({
                    title: 'SuchiGo Waste Management Services',
                    text: 'Check out SuchiGo - Efficient waste collection and recycling solutions!',
                    url: window.location.href
                }).catch(console.error);
            } else {
                // Fallback: Copy to clipboard or open share dialog
                const text = 'Check out SuchiGo - Efficient waste collection and recycling solutions! ' + window.location.href;
                navigator.clipboard.writeText(text).then(() => {
                    alert('Share link copied to clipboard!');
                });
            }
        }

        // Navigation handling
        function showContent(contentType) {
            // Remove active class from all nav links
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });

            // Add active class to clicked nav link
            event.target.closest('.nav-link').classList.add('active');

            // Update content title
            const contentTitle = document.getElementById('contentTitle');
            const titleMap = {
                'dashboard': 'Dashboard Overview',
                'waste-info': 'Waste Information',
                'collected-data': 'Collected Data',
                'customer-mgmt': 'Customer Management',
                'collector-mgmt': 'Waste Collector Management',
                'admin-mgmt': 'Admin Management',
                'admin-profile': 'Admin Profile'
            };

            contentTitle.textContent = titleMap[contentType] || 'Dashboard Overview';

            // Close sidebar on mobile after selection
            if (window.innerWidth <= 768) {
                closeSidebar();
            }
        }

        // Report Generation Functions
        function generateReport(reportType) {
            // Show loading state
            const buttons = document.querySelectorAll('.report-btn');
            let targetButton = null;
            buttons.forEach(btn => {
                if (btn.onclick && btn.onclick.toString().includes(reportType)) {
                    targetButton = btn;
                    btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating...';
                    btn.disabled = true;
                }
            });

            // Make AJAX call to generate report
            fetch('/super_admin_dashboard/reports/generate-report/', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': getCSRFToken()
                },
                body: JSON.stringify({report_type: reportType})
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                return response.json();
            })
            .then(data => {
                if (data.success) {
                    showMessage(`${data.report_name} generated successfully!`, 'success');
                    // Add to report history
                    addToReportHistory(data.report_data);
                } else {
                    showMessage(`Error: ${data.error || 'Failed to generate report'}`, 'error');
                }
            })
            .catch(error => {
                console.error('Error generating report:', error);
                showMessage(`Error: ${error.message}`, 'error');
            })
            .finally(() => {
                // Reset button state
                if (targetButton) {
                    const buttonTexts = {
                        'daily_collection': '<i class="fas fa-calendar-day"></i> Daily Collection Report',
                        'weekly_collection': '<i class="fas fa-calendar-week"></i> Weekly Collection Report',
                        'monthly_collection': '<i class="fas fa-calendar-alt"></i> Monthly Collection Report',
                        'customer_summary': '<i class="fas fa-user-friends"></i> Customer Summary Report',
                        'active_customers': '<i class="fas fa-user-check"></i> Active Customers Report',
                        'customer_growth': '<i class="fas fa-chart-line"></i> Customer Growth Report',
                        'revenue_summary': '<i class="fas fa-file-invoice-dollar"></i> Revenue Summary Report',
                        'payment_analysis': '<i class="fas fa-credit-card"></i> Payment Analysis Report',
                        'outstanding_payments': '<i class="fas fa-exclamation-circle"></i> Outstanding Payments Report',
                        'collector_performance': '<i class="fas fa-truck"></i> Collector Performance Report',
                        'efficiency_metrics': '<i class="fas fa-percentage"></i> Efficiency Metrics Report',
                        'service_level': '<i class="fas fa-star"></i> Service Level Report'
                    };
                    targetButton.innerHTML = buttonTexts[reportType] || 'Generate Report';
                    targetButton.disabled = false;
                }
            });
        }

        function getCSRFToken() {
            // Try multiple ways to get CSRF token
            let csrfToken = document.querySelector('[name=csrfmiddlewaretoken]')?.value || '';

            // If not found, try meta tag
            if (!csrfToken) {
                csrfToken = document.querySelector('meta[name=csrf-token]')?.content || '';
            }

            // If still not found, try cookie
            if (!csrfToken) {
                const cookies = document.cookie.split(';');
                for (let cookie of cookies) {
                    const [name, value] = cookie.trim().split('=');
                    if (name === 'csrftoken') {
                        csrfToken = value;
                        break;
                    }
                }
            }

            if (!csrfToken) {
                console.error('CSRF token not found! This will cause the "Unexpected token <" error');
                // Fallback - try to get from Django's default cookie name
                console.log('Available cookies:', document.cookie);
            }

            console.log('CSRF Token:', csrfToken ? 'FOUND' : 'NOT FOUND');
            return csrfToken;
        }

        function openCustomReportModal(reportCategory) {
            showMessage(`Opening custom ${reportCategory} report configuration...`, 'info');
            // In a real implementation, this would open a modal with custom report options
            alert(`Custom ${reportCategory} report configuration would open here.`);
        }

        function showMessage(message, type = 'info') {
            // Create message element
            const messageEl = document.createElement('div');
            messageEl.className = `message-popup message-${type}`;
            messageEl.innerHTML = `
                <div style="display: flex; align-items: center; gap: 0.5rem;">
                    <i class="fas ${type === 'success' ? 'fa-check-circle' : type === 'error' ? 'fa-exclamation-circle' : 'fa-info-circle'}"></i>
                    <span>${message}</span>
                </div>
            `;

            // Style message
            messageEl.style.cssText = `
                position: fixed;
                top: 100px;
                right: 20px;
                padding: 1rem 1.5rem;
                border-radius: 8px;
                color: white;
                font-weight: 500;
                z-index: 10001;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                transform: translateX(100%);
                transition: transform 0.3s ease;
                ${type === 'success' ? 'background: #28a745;' : type === 'error' ? 'background: #dc3545;' : 'background: #17a2b8;'}
            `;

            // Add to document
            document.body.appendChild(messageEl);

            // Animate in
            setTimeout(() => {
                messageEl.style.transform = 'translateX(0)';
            }, 10);

            // Remove after 3 seconds
            setTimeout(() => {
                messageEl.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    if (messageEl.parentNode) {
                        messageEl.parentNode.removeChild(messageEl);
                    }
                }, 300);
            }, 3000);
        }

        function addToReportHistory(reportData) {
            const historyBody = document.getElementById('reportHistoryBody');

            // Remove the "no reports" message if it exists
            const noReportsRow = historyBody.querySelector('tr td[colspan="5"]');
            if (noReportsRow) {
                historyBody.innerHTML = '';
            }

            // Create new row
            const row = document.createElement('tr');
            const now = new Date();
            const formattedDate = now.toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'short',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });

            row.innerHTML = `
                <td>${reportData.report_name || 'Generated Report'}</td>
                <td>${reportData.report_type?.replace(/_/g, ' ').replace(/\b\w/g, l => l.toUpperCase()) || 'Unknown'}</td>
                <td>${formattedDate}</td>
                <td><span class="status-badge" data-status="Generated">Generated</span></td>
                <td>
                    <div class="action-buttons">
                        <button class="action-btn btn-download" onclick="downloadReport('${reportData.report_type}', 'pdf')">
                            <i class="fas fa-download"></i>
                        </button>
                        <button class="action-btn btn-delete" onclick="deleteReport(this)">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </td>
            `;

            historyBody.insertBefore(row, historyBody.firstChild);
        }

        function downloadReport(reportType, format) {
            showMessage(`Downloading ${format.toUpperCase()} report...`, 'info');

            // Construct the download URL
            const downloadUrl = `/super_admin_dashboard/reports/download-report/0/?type=${reportType}&format=${format}`;

            // Create a temporary link and trigger download
            const link = document.createElement('a');
            link.href = downloadUrl;
            link.target = '_blank';
            link.style.display = 'none';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);

            showMessage(`${format.toUpperCase()} report download started`, 'success');
        }

        function deleteReport(button) {
            if (confirm('Are you sure you want to delete this report?')) {
                const row = button.closest('tr');
                row.remove();

                // Show message
                showMessage('Report deleted successfully', 'success');

                // Check if no reports left
                const historyBody = document.getElementById('reportHistoryBody');
                if (historyBody.children.length === 0) {
                    historyBody.innerHTML = `
                        <tr>
                            <td colspan="5" style="text-align: center; padding: 2rem; color: #666;">
                                No reports generated yet. Generate your first report above.
                            </td>
                        </tr>
                    `;
                }
            }
        }

        // Modal Functions
        function openAssignModal(orderId) {
            console.log('Opening Assign Modal for order:', orderId);
            const assignOrderId = document.getElementById('assignOrderId');
            const assignModal = document.getElementById('assignModal');

            if (assignOrderId && assignModal) {
                assignOrderId.value = orderId;
                assignModal.style.display = 'block';
                console.log('Assign modal opened successfully');
            } else {
                console.error('Assign modal elements not found!');
            }
        }

        function openStatusModal(orderId) {
            console.log('Opening Status Modal for order:', orderId);
            const statusOrderId = document.getElementById('statusOrderId');
            const statusModal = document.getElementById('statusModal');

            if (statusOrderId && statusModal) {
                statusOrderId.value = orderId;
                statusModal.style.display = 'block';
                console.log('Status modal opened successfully');
            } else {
                console.error('Status modal elements not found!');
            }
        }

        function openRescheduleModal(orderId) {
            console.log('Opening Reschedule Modal for order:', orderId);
            const rescheduleOrderId = document.getElementById('rescheduleOrderId');
            const rescheduleModal = document.getElementById('rescheduleModal');
            const newDate = document.getElementById('newDate');

            if (rescheduleOrderId && rescheduleModal && newDate) {
                rescheduleOrderId.value = orderId;
                rescheduleModal.style.display = 'block';
                // Set min date to today
                const today = new Date().toISOString().split('T')[0];
                newDate.min = today;
                console.log('Reschedule modal opened successfully');
            } else {
                console.error('Reschedule modal elements not found!');
            }
        }

        function closeModal(modalId) {
            console.log('Closing modal:', modalId);
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.style.display = 'none';
            }
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.style.display = 'none';
            }
        }

        // Form submissions - Wait for DOM to be fully loaded
        // Test function to verify button clicks
        function testButtonClick(buttonName) {
            console.log('Button clicked:', buttonName);
            alert('Button clicked: ' + buttonName + ' - Check console for details');
        }

        // Debug function to check if functions exist
        function debugFunctions() {
            console.log('=== Debug Info ===');
            console.log('openAssignModal exists:', typeof openAssignModal);
            console.log('openStatusModal exists:', typeof openStatusModal);
            console.log('openRescheduleModal exists:', typeof openRescheduleModal);
            console.log('closeModal exists:', typeof closeModal);
            console.log('getCSRFToken exists:', typeof getCSRFToken);

            // Check if modal elements exist
            console.log('assignModal exists:', !!document.getElementById('assignModal'));
            console.log('statusModal exists:', !!document.getElementById('statusModal'));
            console.log('rescheduleModal exists:', !!document.getElementById('rescheduleModal'));

            // Check CSRF token
            const csrfToken = document.querySelector('[name=csrfmiddlewaretoken]');
            console.log('CSRF token element exists:', !!csrfToken);
            console.log('CSRF token value:', csrfToken ? csrfToken.value : 'NOT FOUND');

            alert('Debug info logged to console - please check browser developer tools');
        }

        document.addEventListener('DOMContentLoaded', function() {
            // Set min date for reschedule input
            const rescheduleDateInput = document.getElementById('newDate');
            if (rescheduleDateInput) {
                const today = new Date().toISOString().split('T')[0];
                rescheduleDateInput.min = today;
            }

            // Assign Form Submission
            const assignForm = document.getElementById('assignForm');
            if (assignForm) {
                assignForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    const orderId = document.getElementById('assignOrderId').value;
                    const collectorId = document.getElementById('collectorSelect').value;

                    if (collectorId) {
                        const submitBtn = this.querySelector('button[type="submit"]');
                        const originalText = submitBtn.innerHTML;
                        submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Assigning...';
                        submitBtn.disabled = true;

                        const url = `{% url 'super_admin_dashboard:manage_order' 0 %}`.replace('0', orderId);
                        console.log('Making request to:', url);

                        fetch(url, {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/x-www-form-urlencoded',
                                'X-CSRFToken': getCSRFToken()
                            },
                            body: `action=assign_collector&collector_id=${collectorId}`
                        })
                        .then(response => {
                            // Check if response is OK
                            if (!response.ok) {
                                console.error('Response not OK:', response.status, response.statusText);
                                return response.text().then(text => {
                                    console.error('Error response body:', text);
                                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                                });
                            }
                            return response.json();
                        })
                        .then(data => {
                            if (data.success) {
                                showMessage(`Order assigned to collector successfully!`, 'success');
                                closeModal('assignModal');
                                location.reload();
                            } else {
                                showMessage('Error: ' + (data.error || 'Failed to assign collector'), 'error');
                            }
                        })
                        .catch(error => {
                            console.error('Error:', error);
                            showMessage('Error: ' + error.message, 'error');
                        })
                        .finally(() => {
                            submitBtn.innerHTML = originalText;
                            submitBtn.disabled = false;
                        });
                    } else {
                        showMessage('Please select a collector', 'error');
                    }
                });
            }

            // Status Form Submission
            const statusForm = document.getElementById('statusForm');
            if (statusForm) {
                statusForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    const orderId = document.getElementById('statusOrderId').value;
                    const newStatus = document.getElementById('statusSelect').value;

                    if (newStatus) {
                        const submitBtn = this.querySelector('button[type="submit"]');
                        const originalText = submitBtn.innerHTML;
                        submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Updating...';
                        submitBtn.disabled = true;

                        const url = `{% url 'super_admin_dashboard:manage_order' 0 %}`.replace('0', orderId);
                        console.log('Making request to:', url);

                        fetch(url, {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/x-www-form-urlencoded',
                                'X-CSRFToken': getCSRFToken()
                            },
                            body: `action=update_status&status=${newStatus}`
                        })
                        .then(response => {
                            // Check if response is OK
                            if (!response.ok) {
                                console.error('Response not OK:', response.status, response.statusText);
                                return response.text().then(text => {
                                    console.error('Error response body:', text);
                                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                                });
                            }
                            return response.json();
                        })
                        .then(data => {
                            if (data.success) {
                                showMessage(`Order status updated to ${newStatus}!`, 'success');
                                closeModal('statusModal');
                                location.reload();
                            } else {
                                showMessage('Error: ' + (data.error || 'Failed to update status'), 'error');
                            }
                        })
                        .catch(error => {
                            console.error('Error:', error);
                            showMessage('Error: ' + error.message, 'error');
                        })
                        .finally(() => {
                            submitBtn.innerHTML = originalText;
                            submitBtn.disabled = false;
                        });
                    } else {
                        showMessage('Please select a status', 'error');
                    }
                });
            }

            // Reschedule Form Submission
            const rescheduleForm = document.getElementById('rescheduleForm');
            if (rescheduleForm) {
                rescheduleForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    const orderId = document.getElementById('rescheduleOrderId').value;
                    const newDate = document.getElementById('newDate').value;

                    if (newDate) {
                        const submitBtn = this.querySelector('button[type="submit"]');
                        const originalText = submitBtn.innerHTML;
                        submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Rescheduling...';
                        submitBtn.disabled = true;

                        const url = `{% url 'super_admin_dashboard:manage_order' 0 %}`.replace('0', orderId);
                        console.log('Making request to:', url);

                        fetch(url, {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/x-www-form-urlencoded',
                                'X-CSRFToken': getCSRFToken()
                            },
                            body: `action=reschedule&new_date=${newDate}`
                        })
                        .then(response => {
                            // Check if response is OK
                            if (!response.ok) {
                                console.error('Response not OK:', response.status, response.statusText);
                                return response.text().then(text => {
                                    console.error('Error response body:', text);
                                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                                });
                            }
                            return response.json();
                        })
                        .then(data => {
                            if (data.success) {
                                showMessage(`Order rescheduled to ${newDate}!`, 'success');
                                closeModal('rescheduleModal');
                                location.reload();
                            } else {
                                showMessage('Error: ' + (data.error || 'Failed to reschedule'), 'error');
                            }
                        })
                        .catch(error => {
                            console.error('Error:', error);
                            showMessage('Error: ' + error.message, 'error');
                        })
                        .finally(() => {
                            submitBtn.innerHTML = originalText;
                            submitBtn.disabled = false;
                        });
                    } else {
                        showMessage('Please select a date', 'error');
                    }
                });
            }
        });

      

       

        

        // Close modal on outside click
        window.onclick = function (event) {
            const modal = document.getElementById('aboutUsModal');
            if (event.target === modal) {
                closeAboutUsModal();
            }
        }
    </script>
</body>

</html>
